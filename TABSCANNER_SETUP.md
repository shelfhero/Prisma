# TabScanner API Настройка за Призма

## Какво е TabScanner?

TabScanner е специализиран OCR (Optical Character Recognition) сервис, който е оптимизиран за касови бележки. Той може да разпознава текст, цени, продукти и други данни от снимки на касови бележки с висока точност.

## Стъпки за настройка

### 1. Създаване на акаунт

1. **Отидете на официалния сайт**: https://tabscanner.com
2. **Кликнете "Sign Up"** в горния десен ъгъл
3. **Попълнете формата за регистрация**:
   - Имейл адрес
   - Парола (поне 8 символа)
   - Име на компанията (може да въведете "Призма")
4. **Потвърдете имейла си** - проверете пощенската си кутия
5. **Влезте в акаунта си**

### 2. Настройка на API ключ

1. **Влезте в Dashboard**: https://tabscanner.com/dashboard
2. **Отидете в секция "API Keys"** (лявото меню)
3. **Кликнете "Create New API Key"**
4. **Попълнете данните**:
   - **Name**: "Призма Production" (или "Призма Development")
   - **Description**: "API ключ за българското приложение Призма"
   - **Rate Limit**: Изберете според вашите нужди
5. **Запазете ключа** - той ще се покаже само веднъж!
6. **Копирайте ключа** и го запазете в сигурно място

### 3. Конфигуриране на Призма

1. **Отворете .env.local файла** в проекта
2. **Намерете реда с TABSCANNER_API_KEY**
3. **Заменете placeholder стойността** с вашия истински ключ:

```bash
# Преди
TABSCANNER_API_KEY=your_tabscanner_api_key_here

# След
TABSCANNER_API_KEY=ts_live_1234567890abcdef...
```

4. **Проверете endpoint-а** (по подразбиране е правилен):

```bash
TABSCANNER_ENDPOINT=https://api.tabscanner.com/api/2/process
```

### 4. Тестване на настройката

1. **Стартирайте приложението**:
```bash
npm run dev
```

2. **Отидете на upload страницата**: http://localhost:3000/upload-receipt

3. **Качете тестова касова бележка** и проверете дали обработката работи

4. **Проверете конзолата за грешки** - ако всичко е наред, няма да има грешки свързани с TabScanner

## Ценообразуване

TabScanner има различни тарифни планове:

- **Free Tier**: 100 безплатни заявки месечно
- **Starter**: $29/месец за 1,000 заявки
- **Pro**: $99/месец за 5,000 заявки
- **Enterprise**: Индивидуални цени за големи обеми

## Поддържани формати

TabScanner поддържа:
- **Формати**: PNG, JPG, JPEG, PDF
- **Размер**: До 10MB на файл
- **Разделителна способност**: Минимум 300 DPI за най-добри резултати
- **Езици**: Български, английски и още 40+ езика

## Оптимизация на резултатите

За най-добри резултати с български касови бележки:

### Качество на снимката
- Използвайте добро осветление
- Избягвайте сенки и отблясъци
- Снимайте перпендикулярно на бележката
- Уверете се, че текстът е четлив

### Настройки в кода
```typescript
// В API заявката към TabScanner
formData.append('language', 'bg'); // Български език
formData.append('currency', 'BGN'); // Българска валута
formData.append('return_raw_text', 'true'); // Връща сурови данни
```

## Грешки и решения

### Чести проблеми:

**1. "API key not found" грешка**
- Проверете дали ключът е правилно копиран в .env.local
- Уверете се, че няма интервали в началото или края
- Проверете дали ключът не е изтекъл

**2. "Rate limit exceeded" грешка**
- Достигнали сте лимита от заявки
- Изчакайте до следващия период или надградете плана

**3. "Invalid image format" грешка**
- Проверете формата на файла (PNG, JPG)
- Уверете се, че файлът не е повреден

**4. Ниска точност на разпознаване**
- Подобрете качеството на снимката
- Проверете осветлението
- Уверете се, че бележката е изправена

### Debugging

За да дебъгвате проблеми:

1. **Проверете логовете** в конзолата на браузъра
2. **Включете development режим** в .env.local:
```bash
NODE_ENV=development
```
3. **Проверете Network таба** в Developer Tools за HTTP заявките

## Алтернативи

Ако TabScanner не работи добре за вас, можете да използвате:

- **Google Cloud Vision API**
- **AWS Textract**
- **Azure Computer Vision**
- **Tesseract.js** (безплатен, но по-малко точен)

## Поддръжка

За проблеми с TabScanner:
- **Документация**: https://docs.tabscanner.com
- **Поддръжка**: support@tabscanner.com
- **Status Page**: https://status.tabscanner.com

За проблеми с Призма:
- Проверете конзолата за грешки
- Уверете се, че всички environment variables са зададени
- Тествайте с различни типове касови бележки

## Пример заявка

Ето как изглежда типична заявка към TabScanner от Призма:

```typescript
const formData = new FormData();
formData.append('api_key', process.env.TABSCANNER_API_KEY);
formData.append('image_0', imageFile);
formData.append('language', 'bg');
formData.append('currency', 'BGN');
formData.append('return_raw_text', 'true');

const response = await fetch('https://api.tabscanner.com/api/2/process', {
  method: 'POST',
  body: formData,
  headers: {
    'User-Agent': 'Призма-App/1.0'
  }
});
```

## Заключение

TabScanner е мощен инструмент за обработка на касови бележки. С правилната настройка и оптимизация, той може значително да подобри потребителското изживяване в Призма.